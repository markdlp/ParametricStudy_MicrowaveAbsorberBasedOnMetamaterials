\section{\textsf{Simulation}} 
    The simulation was conducted using CST (Computer Simulation Technology)
    software to implement a configuration inspired by the design presented 
    in \cite{zhang_design_2023}. This section outlines the steps taken to 
    model the structure, the assumptions made, and the results obtained from
    the simulation.

    \subsection{\textsf{CST Implementation}} 
        The vertical layout in CST consists of a three-layer structure:
        \begin{itemize}
        \item \textbf{Dielectric Substrate}:  This layer serves as the 
            base for the structure.
        \item \textbf{Air Gap}: Positioned above the dielectric substrate,
            this layer introduces an air gap to influence the electromagnetic 
            properties.
        \item \textbf{Metal Backplate}: The top layer, made of copper, 
            acts as a reflective surface.
        \end{itemize}

        The dielectric substrate also includes a metallic component, which
        is made of the same material as the metal backplateâ€”copper, with
        a conductivity of (5.96 \mu $10^7$ S/m).

        Initially, the FR-4 substrate is placed without the metal 
        resonance layer. The other two layers are positioned below $Z=0$. 
        When viewed from the orthographic side, the layout appears as shown
        in Figure \ref{img:layout}.
        \begin{figure}[h]
            \centering
            \includegraphics[width=0.4\textwidth]{substrate.png}\hfil
            \includegraphics[width=0.4\textwidth]{verticaLayout.png}
            \caption{Basic Vertical Layout}
            \label{img:layout}
        \end{figure}

        Next, a ring resonator is added on top of the dielectric substrate. 
        The ring is made of the same material and thickness as the backplate, 
        as illustrated in Figure \ref{img:ring}.
        \begin{figure}[h]
            \centering
            \includegraphics[width=0.6\textwidth]{ring.png}
            \caption{Ring Resonator}
            \label{img:ring}
        \end{figure}

        An important assumption in this design is that both the body and the 
        tip of the arrow have a width of $\alpha=0.5 mm$. To accurately place
        the curve points defining the arrow, a system of equations must be 
        solved to determine the Cartesian coordinates of the arrow's base points. 
        These points lie on the arc of the ring and are equidistant from the curve 
        $y=x$. The following MATLAB code snippet demonstrates the solution to this 
        system:
        \begin{lstlisting}[frame=single, numbers=left, style=Matlab-Pyglike]
            syms x1 x2

            eq1 = 2*(x1 - x2)^2 == .5^2; eq2 = sqrt(x2^2 + x1^2) == 2.7;

            sol = solve([eq1, eq2], [x1 x2]); disp([sol.x1 sol.x2]);  
        \end{lstlisting}
        
        This system simplifies to the equations shown in Equation \ref{eq:xysys}.
        \begin{equation}
            \label{eq:xysys}
            \displaystyle \begin{array}{l} 
                \left(\begin{array}{cc} 
                    \sigma_3 -\frac{2916\,\sigma_1 }{1433} & -\sigma_1 \\
                    \sigma_4 -\frac{2916\,\sigma_2 }{1433} & -\sigma_2 \\
                    \frac{2916\,\sigma_1 }{1433}-\sigma_3  & \sigma_1 \\
                    \frac{2916\,\sigma_2 }{1433}-\sigma_4  & \sigma_2  
                \end{array}\right)\\
                \mathrm{}\\
                \textrm{where}\\
                \mathrm{}\\
                \;\;\sigma_1 =\sqrt{\frac{729}{200}-\frac{7\,\sqrt{59}}{80}}\\
                \mathrm{}\\
                \;\;\sigma_2 =\sqrt{\frac{7\,\sqrt{59}}{80}+\frac{729}{200}}\\
                \mathrm{}\\
                \;\;\sigma_3 =\frac{400\,{{\left(\frac{729}{200}-\frac{7\,\sqrt{59}}{80}\right)}}^{3/2} }{1433}\\
                \mathrm{}\\
                \;\;\sigma_4 =\frac{400\,{{\left(\frac{7\,\sqrt{59}}{80}+\frac{729}{200}\right)}}^{3/2} }{1433}
            \end{array}
        \end{equation}

        The arrow is then mirrored across the X, Y, and XY planes to cover all
        four sides of the cell. The face is covered with copper, and a height of 
        $d=0.035 mm$ is assigned, as shown in Figure \ref{img:mirrorAndCover}. 
        This step is crucial because all other layers were initially positioned 
        below $Z=0$.
        \begin{figure}[h]
            \centering
            \includegraphics[width=.4\textwidth]{mirroredArrows.png}\hfil
            \includegraphics[width=.4\textwidth]{RingAndArrows.png}
            \caption{Mirroring Arrow and Cover}
            \label{img:mirrorAndCover}
        \end{figure}

        A series of cuts (boolean subtractions) are made in the resonance layer
        to add resistors between the copper faces near the arrows, as depicted 
        in Figure \ref{img:arrowCuts}.
        \begin{figure}[h]
            \centering
            \includegraphics[width=.4\textwidth]{subtract.png}\hfil
            \includegraphics[width=.4\textwidth]{subtracted.png}
            \caption{Cuts Near the Arrows}
            \label{img:arrowCuts}
        \end{figure}

        Similar cuts are made near the ring to ensure uniform width, as shown 
        in Figure \ref{img:ringCuts}.
        \begin{figure}[h]
            \centering
            \includegraphics[width=.4\textwidth]{subtractRing.png}\hfil
            \includegraphics[width=.4\textwidth]{subtractedRing.png}
            \caption{Cuts Near the Ring}
            \label{img:ringCuts}
        \end{figure}

        Resistors are then added, connecting to the center points of the faces
        created by the previous subtractions, as illustrated in Figure 
        \ref{img:resistors}. It is important to note that the performance of 
        the absorber may be reduced in this implementation. Better absorbance 
        might be achieved if the connection height is set to $d=0.035mm$.

        To perform the simulation using the frequency solver in CST, periodic 
        boundaries are set along the XY plane, and free space conditions are 
        applied along the Z axis. The resulting mesh is shown in Figure 
        \ref{img:RingAndArrowMesh}.
        
        \begin{figure}
            \centering
            \begin{subfigure}{0.4\textwidth}
                \centering
                \includegraphics[width= \textwidth]{faceCenterPoint.png}
                \caption{Resistor Placement}
                \label{img:resistors}
            \end{subfigure}
            \hfill
            \begin{subfigure}{0.40\textwidth}
                \centering
                \includegraphics[width= \textwidth]{mesh.png}
                \caption{Ring Mesh for reference}
                \label{img:RingAndArrowMesh}
            \end{subfigure}
            \caption{Mesh around Resistors}
            \label{fig:combined}
        \end{figure}

        The electrical field absorbance is analyzed at different frequencies. 
        Figure \ref{img:E_Zmax1} shows the electrical field for $Z_{max}(1)$
        at frequencies of 2.7 GHz, 7.7 GHz, and 12.7 GHz.
        \begin{figure}[h]
            \centering
            
            \includegraphics[page=1, width=0.22\textwidth]{E_Zmax1_027e2MHz.png}\hfil
            \includegraphics[page=1, width=0.22\textwidth]{E_Zmax1_077e2MHz.png}\hfil
            \includegraphics[page=1, width=0.22\textwidth]{E_Zmax1_127e2MHz.png}
            
            \caption{Electrical Field for [2.7, 7.7, 12.7] GHz $Z_{max}(1)$}
            \label{img:E_Zmax1}
        \end{figure}

        Similarly, Figure \ref{img:E_Zmax2} shows the electrical field for $Z_{max}(2)$
        at the same frequencies.
        \begin{figure}[h]
            \centering
            
            \includegraphics[page=1, width=0.22\textwidth]{E_Zmax2_027e2MHz.png}\hfil
            \includegraphics[page=1, width=0.22\textwidth]{E_Zmax2_077e2MHz.png}\hfil
            \includegraphics[page=1, width=0.22\textwidth]{E_Zmax2_127e2MHz.png}
            
            \caption{Electrical Field for [2.7, 7.7, 12.7] GHz $Z_{max}(2)$}
            \label{img:E_Zmax2}
        \end{figure}

        Taking a look in the $S_{11}$ of $Z_{max}$ after the simulation as such
        (\ref{plt:S11_Zmax}). The Absorptivity (against the frequency) is an
        essential metric and CST calculates it as shown in (\ref{plt:Absorptivity}).
        For the evaluation of the absorber Absorptivity can be calculated using the
        formula: $ A = 1 - |S_{11}|^2 - |T|^2 $, where T is the transmission
        coefficient and can be calculated using the formula: $T =
        \frac{2Z_0}{Z+Z_0}$. However the $Z$ mentioned needs to be the normalized
        impedance of the absorber so this is where the calculation will start.

        \begin{center}
            \begin{minipage}{.45\textwidth}
                \begin{tikzpicture}
                    \begin{axis}[ 
                        title={\textsf{Reflection Coefficient}},
                        xlabel={Frequency (GHz)}, ylabel={$S_{11}$ (dB)} 
                    ] \addplot table[x=freq, y=s11, col sep=space] {data/s11.txt};
                    \end{axis}
                \end{tikzpicture}
                %\captionof{figure}{\textsf{The $S_{11}$}}
                \label{plt:S11_Zmax}
            \end{minipage}
            \begin{minipage}{.45\textwidth}
                \begin{tikzpicture}
                    \begin{axis}[ 
                        title={\textsf{A/\small\lambda}},
                        xlabel={Wavelength (\lambda)}, ylabel={Absorptivity},
                        ymin=0.8, ymax=1 
                    ] \addplot table[x=lambda, y=A, col sep=space] {data/Absorptivity.txt};
                    \end{axis}
                \end{tikzpicture}
                %\captionof{figure}{\textsf{Absorptivity against Wavelength}}
                \label{plt:Absorptivity}
            \end{minipage}
        \end{center}
       
        The relative permittivity (\epsilon) and permeability (\mu) are extracted 
        from the $S_{11}$ and $S_{12}$ parameters. Their imaginary parts are shown 
        in Figure \ref{plt:EpsilonMu}.
        \begin{figure}[h]
            \centering
            \begin{tikzpicture}%[trim axis left, trim axis right]
                \begin{axis}[ 
                    title={\textsf{Relative Permittivity \& Permeability}},
                    xlabel={Frequency (GHz)}, ylabel={$\epsilon_{eff} \& \mu_{eff}$},
                    legend pos=north east 
                ]   
                    \addplot table[x=freq, y=Re, col sep=tab] {data/Epsilon.txt}; 
                    \addplot[dashed] table[x=freq, y=Im, col sep=tab] {data/Epsilon.txt};
    
                    \addplot table[x=freq, y=Re, col sep=tab] {data/Mu.txt};
                    \addplot[dashed] table[x=freq, y=Im, col sep=tab] {data/Mu.txt};

                    \addlegendentry{\Re(\epsilon)}
                    \addlegendentry{\Im(\epsilon)}
                    \addlegendentry{\Re(\mu)}
                    \addlegendentry{\Im(\mu)}
                
                \end{axis}
            \end{tikzpicture}
            \caption{\textsf{Effective $\epsilon \& \mu$}}
            \label{plt:EpsilonMu}
        \end{figure}
        

        \subsection{\textsf{Alternative Modeling Methods}}

            In addition to the CST simulation, there are several alternative methods
            to model the absorber:
            \begin{itemize}
                \item \textbf{Transmission Line Equivalent}: This method models the 
                    absorber as a transmission line, which can be useful for 
                    understanding the impedance matching and wave propagation.
                \item \textbf{Electrical Circuit Equivalent}: The absorber can be 
                    represented as an equivalent electrical circuit, simplifying the
                    analysis of its behavior.
                \item \textbf{Mathematical Modeling \& Code (MATLAB)}: Numerical methods
                    and coding in MATLAB can be used to simulate the absorber's 
                    performance, providing flexibility in parameter adjustments.
            \end{itemize}
        
            After completing the CST simulation, the impedance of the absorber can be 
            extracted, which is useful for implementing the transmission line equivalent model.
